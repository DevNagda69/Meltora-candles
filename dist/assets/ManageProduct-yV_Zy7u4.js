import{r as e,j as s,c as i,K as a,D as r,k as n,z as l}from"./vendor-react-core-Bq0KXPxd.js";import{A as t}from"./AdminLayout-ela2jhCS.js";import{B as c}from"./index-Bc6h3JDl.js";import{b as o,u as d,c as u}from"./productService-CoEyuARZ.js";import"./vendor-misc-DR8gDw69.js";import"./vendor-firebase-DEvV9JSG.js";import"./dataCache-BlbMQbVs.js";const m=({initialData:r,onSubmit:n,loading:l})=>{const[t,o]=e.useState({name:"",description:"",price:"",salePrice:"",category:"Floral",collection:"Signature",scent:"",size:"Medium (200g)",stock:"",ingredients:"",burnTime:""}),[d,u]=e.useState(null),[m,p]=e.useState(null);e.useEffect(()=>{r&&(o({name:r.name||"",description:r.description||"",price:r.price||"",salePrice:r.salePrice||"",category:r.category||"Floral",collection:r.collection||"Signature",scent:r.scent||"",size:r.size||"Medium (200g)",stock:r.stock||"",ingredients:r.ingredients||"",burnTime:r.burnTime||""}),r.image&&p(r.image))},[r]);const x=e=>{const{name:s,value:i}=e.target;o(e=>({...e,[s]:i}))},[h,j]=e.useState({});return s.jsxs("form",{onSubmit:e=>{if(e.preventDefault(),!(()=>{const e={};return t.name||(e.name="Name is required"),(!t.price||t.price<=0)&&(e.price="Valid price is required"),(!t.stock||t.stock<0)&&(e.stock="Stock cannot be negative"),m||id||(e.image="Image is required for new products"),j(e),0===Object.keys(e).length})())return void toast.error("Please fix the errors in the form");const s={...t,price:Number(t.price),salePrice:t.salePrice?Number(t.salePrice):null,stock:Number(t.stock)};n(s,d)},className:"product-form",children:[s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-column",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Product Name"}),s.jsx("input",{type:"text",name:"name",value:t.name,onChange:x,required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Description"}),s.jsx("textarea",{name:"description",rows:"4",value:t.description,onChange:x,required:!0})]}),s.jsxs("div",{className:"form-row",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Price (â‚¹)"}),s.jsx("input",{type:"number",name:"price",value:t.price,onChange:x,required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Sale Price (Optional)"}),s.jsx("input",{type:"number",name:"salePrice",value:t.salePrice,onChange:x})]})]}),s.jsxs("div",{className:"form-row",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Category"}),s.jsxs("select",{name:"category",value:t.category,onChange:x,children:[s.jsx("option",{value:"Floral",children:"Floral"}),s.jsx("option",{value:"Woody",children:"Woody"}),s.jsx("option",{value:"Fresh",children:"Fresh"}),s.jsx("option",{value:"Sweet",children:"Sweet"}),s.jsx("option",{value:"Citrus",children:"Citrus"}),s.jsx("option",{value:"Spicy",children:"Spicy"}),s.jsx("option",{value:"Relaxation",children:"Relaxation"}),s.jsx("option",{value:"Festive",children:"Festive"})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Collection"}),s.jsxs("select",{name:"collection",value:t.collection,onChange:x,children:[s.jsx("option",{value:"Signature",children:"Signature"}),s.jsx("option",{value:"Seasonal",children:"Seasonal"}),s.jsx("option",{value:"Limited Edition",children:"Limited Edition"}),s.jsx("option",{value:"Gift Sets",children:"Gift Sets"})]})]})]})]}),s.jsxs("div",{className:"form-column",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Product Image"}),s.jsx("div",{className:"image-upload-area",children:m?s.jsxs("div",{className:"image-preview",children:[s.jsx("img",{src:m,alt:"Preview"}),s.jsx("button",{type:"button",className:"remove-image",onClick:()=>{u(null),p(null)},children:s.jsx(i,{})})]}):s.jsxs("div",{className:"upload-placeholder",children:[s.jsx("input",{type:"file",id:"image-upload",accept:"image/*",onChange:e=>{const s=e.target.files[0];if(s){u(s);const e=new FileReader;e.onloadend=()=>{p(e.result)},e.readAsDataURL(s)}}}),s.jsxs("label",{htmlFor:"image-upload",children:[s.jsx(a,{}),s.jsx("span",{children:"Click to upload image"})]})]})})]}),s.jsxs("div",{className:"form-row",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Stock Quantity"}),s.jsx("input",{type:"number",name:"stock",value:t.stock,onChange:x,required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Size Label"}),s.jsx("input",{type:"text",name:"size",value:t.size,onChange:x,placeholder:"e.g. Medium (200g)"})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Scent Notes"}),s.jsx("input",{type:"text",name:"scent",value:t.scent,onChange:x,placeholder:"e.g. Jasmine, Sandalwood"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Ingredients"}),s.jsx("textarea",{name:"ingredients",rows:"2",value:t.ingredients,onChange:x})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Burn Time"}),s.jsx("input",{type:"text",name:"burnTime",value:t.burnTime,onChange:x,placeholder:"e.g. 40-50 hours"})]})]})]}),s.jsx("div",{className:"form-actions mt-6",children:s.jsx(c,{variant:"primary",type:"submit",loading:l,children:r?"Update Product":"Create Product"})})]})},p=()=>{const{id:i}=r(),a=n(),[c,p]=e.useState(!1),[x,h]=e.useState(null),[j,g]=e.useState(!!i);e.useEffect(()=>{i&&v()},[i]);const v=async()=>{try{const e=await o(i);h(e)}catch(e){l.error("Failed to load product"),a("/admin/products")}finally{g(!1)}};return j?s.jsx(t,{title:i?"Edit Product":"Add Product",children:s.jsx("div",{className:"text-center py-8",children:"Loading..."})}):s.jsx(t,{title:i?"Edit Product":"Add Product",children:s.jsx("div",{className:"max-w-4xl mx-auto",children:s.jsx(m,{initialData:x,onSubmit:async(e,s)=>{p(!0);try{i?(await d(i,e,s),l.success("Product updated successfully")):(await u(e,s),l.success("Product created successfully")),a("/admin/products")}catch(r){l.error(i?"Failed to update product":"Failed to create product")}finally{p(!1)}},loading:c})})})};export{p as default};
