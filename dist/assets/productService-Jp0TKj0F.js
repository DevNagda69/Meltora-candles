import{n as a,m as t,d as s,c as d,t as i,v as e,w as r,x as o,y as n,l as c,q as u,r as p,p as m,k as w}from"./vendor-firebase-DEvV9JSG.js";import{d as f,s as y}from"./index-DJL7qJUu.js";import{d as g}from"./dataCache-BlbMQbVs.js";const l="products",v=async()=>{const s=g.get("products");if(s)return s;const d=(await a(t(f,l))).docs.map(a=>({id:a.id,...a.data()}));return g.set("products",d),d},$=async a=>{const t=s(f,l,a),i=await d(t);if(i.exists())return{id:i.id,...i.data()};throw new Error("Product not found")},x=async(s=4)=>{const d=u(t(f,l),m("createdAt","desc"),p(s));return(await a(d)).docs.map(a=>({id:a.id,...a.data()}))},A=async(a,s)=>{let d="";if(s){const a=e(y,`products/${Date.now()}_${s.name}`),t=await r(a,s);d=await o(t.ref)}const i=await c(t(f,l),{...a,image:d,createdAt:w(),updatedAt:w()});return g.invalidate("products"),{id:i.id,...a,image:d}},j=async a=>{await i(s(f,l,a)),g.invalidate("products"),g.invalidate(`product_${a}`)},_=async(a,t,d)=>{let i=t.image;if(d){const a=e(y,`products/${Date.now()}_${d.name}`),t=await r(a,d);i=await o(t.ref)}const c=s(f,l,a);await n(c,{...t,image:i,updatedAt:w()})};export{v as a,$ as b,A as c,j as d,x as g,_ as u};
